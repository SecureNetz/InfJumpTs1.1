-- DELTA ANIMATION HUB (STABLE VERSION)
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local player = Players.LocalPlayer

-- CLEANUP PREVIOUS SESSIONS
local existing = player.PlayerGui:FindFirstChild("DeltaAnimationHub")
if existing then existing:Destroy() end

-- GUI SETUP
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "DeltaAnimationHub"
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = player:WaitForChild("PlayerGui")

local Main = Instance.new("Frame", ScreenGui)
Main.Size = UDim2.new(0, 460, 0, 420)
Main.Position = UDim2.new(0.5, -230, 0.5, -210) -- Centered
Main.BackgroundColor3 = Color3.fromRGB(28, 28, 38)
Main.BorderSizePixel = 0
Main.Active = true
Main.Draggable = true

Instance.new("UICorner", Main).CornerRadius = UDim.new(0, 14)
local Stroke = Instance.new("UIStroke", Main)
Stroke.Color = Color3.fromRGB(0, 255, 160)
Stroke.Thickness = 3

-- TITLE
local Title = Instance.new("TextLabel", Main)
Title.Size = UDim2.new(1, -60, 0, 50)
Title.Position = UDim2.new(0, 20, 0, 10)
Title.BackgroundTransparency = 1
Title.Text = "üé≠ ANIMATION HUB"
Title.Font = Enum.Font.GothamBold
Title.TextColor3 = Color3.fromRGB(0, 255, 160)
Title.TextSize = 20
Title.TextXAlignment = Enum.TextXAlignment.Left

-- CLOSE BUTTON
local Close = Instance.new("TextButton", Main)
Close.Size = UDim2.new(0, 36, 0, 36)
Close.Position = UDim2.new(1, -46, 0, 14)
Close.Text = "X"
Close.Font = Enum.Font.GothamBold
Close.BackgroundColor3 = Color3.fromRGB(255, 80, 80)
Close.TextColor3 = Color3.new(1, 1, 1)
Instance.new("UICorner", Close).CornerRadius = UDim.new(0, 8)

-- ID INPUT
local Input = Instance.new("TextBox", Main)
Input.Size = UDim2.new(1, -40, 0, 44)
Input.Position = UDim2.new(0, 20, 0, 70)
Input.PlaceholderText = "Enter Animation ID..."
Input.Text = "507766388"
Input.Font = Enum.Font.Gotham
Input.BackgroundColor3 = Color3.fromRGB(45, 45, 55)
Input.TextColor3 = Color3.new(1, 1, 1)
Input.TextSize = 18
Instance.new("UICorner", Input).CornerRadius = UDim.new(0, 10)

-- BUTTONS: LOAD & STOP
local Load = Instance.new("TextButton", Main)
Load.Size = UDim2.new(0.48, -15, 0, 52)
Load.Position = UDim2.new(0, 20, 0, 130)
Load.Text = "‚ñ∂ PLAY"
Load.Font = Enum.Font.GothamBold
Load.BackgroundColor3 = Color3.fromRGB(0, 255, 160)
Load.TextColor3 = Color3.fromRGB(30, 30, 40)
Instance.new("UICorner", Load).CornerRadius = UDim.new(0, 10)

local Stop = Instance.new("TextButton", Main)
Stop.Size = UDim2.new(0.48, -15, 0, 52)
Stop.Position = UDim2.new(0.52, 0, 0, 130)
Stop.Text = "‚èπ STOP"
Stop.Font = Enum.Font.GothamBold
Stop.BackgroundColor3 = Color3.fromRGB(255, 100, 100)
Stop.TextColor3 = Color3.new(1, 1, 1)
Instance.new("UICorner", Stop).CornerRadius = UDim.new(0, 10)

-- SPEED CONTROL
local Speed = Instance.new("TextBox", Main)
Speed.Size = UDim2.new(1, -40, 0, 36)
Speed.Position = UDim2.new(0, 20, 0, 210)
Speed.PlaceholderText = "Speed (Default: 1)"
Speed.Text = "1"
Speed.Font = Enum.Font.Gotham
Speed.BackgroundColor3 = Color3.fromRGB(50, 50, 60)
Speed.TextColor3 = Color3.new(1, 1, 1)
Instance.new("UICorner", Speed).CornerRadius = UDim.new(0, 8)

-- STATUS DISPLAY
local Status = Instance.new("TextLabel", Main)
Status.Size = UDim2.new(1, -40, 0, 36)
Status.Position = UDim2.new(0, 20, 0, 260)
Status.BackgroundColor3 = Color3.fromRGB(45, 45, 55)
Status.Text = "‚úÖ Ready"
Status.Font = Enum.Font.GothamBold
Status.TextColor3 = Color3.fromRGB(0, 255, 160)
Instance.new("UICorner", Status).CornerRadius = UDim.new(0, 8)

-- EMOTE PRESETS
local Emotes = {
    {"Wave", 507766388},
    {"Floss", 505757002},
    {"Dance", 522635514},
    {"Crab", 522635821}
}

for i, e in ipairs(Emotes) do
    local B = Instance.new("TextButton", Main)
    B.Size = UDim2.new(0, 100, 0, 36)
    B.Position = UDim2.new(0, 20 + (i-1) * 110, 0, 320)
    B.Text = e[1]
    B.Font = Enum.Font.Gotham
    B.BackgroundColor3 = Color3.fromRGB(60, 60, 70)
    B.TextColor3 = Color3.new(1, 1, 1)
    Instance.new("UICorner", B).CornerRadius = UDim.new(0, 8)

    B.MouseButton1Click:Connect(function()
        Input.Text = tostring(e[2])
        Status.Text = "Selected: " .. e[1]
    end)
end

-- ANIMATION ENGINE
local currentTrack = nil

local function playAnim(id)
    local char = player.Character
    if not char then Status.Text = "‚ùå No Character"; return end
    
    local hum = char:FindFirstChildOfClass("Humanoid")
    local animator = hum and hum:FindFirstChildOfClass("Animator")
    if not animator then Status.Text = "‚ùå No Animator"; return end

    -- Stop previous
    if currentTrack then currentTrack:Stop() currentTrack:Destroy() end

    local anim = Instance.new("Animation")
    anim.AnimationId = "rbxassetid://" .. tostring(id)

    local success, track = pcall(function()
        return animator:LoadAnimation(anim)
    end)

    if success then
        currentTrack = track
        currentTrack.Looped = true
        currentTrack:Play()
        currentTrack:AdjustSpeed(tonumber(Speed.Text) or 1)
        Status.Text = "‚ñ∂ Playing: " .. id
    else
        Status.Text = "‚ùå Error Loading ID"
    end
end

-- LOGIC CONNECTIONS
Load.MouseButton1Click:Connect(function()
    local cleanID = Input.Text:match("%d+")
    if cleanID then playAnim(cleanID) else Status.Text = "‚ùå Invalid ID" end
end)

Stop.MouseButton1Click:Connect(function()
    if currentTrack then
        currentTrack:Stop()
        currentTrack:Destroy()
        currentTrack = nil
        Status.Text = "‚èπ Stopped"
    end
end)

Speed:GetPropertyChangedSignal("Text"):Connect(function()
    if currentTrack then
        currentTrack:AdjustSpeed(tonumber(Speed.Text) or 1)
    end
end)

Close.MouseButton1Click:Connect(function()
    if currentTrack then currentTrack:Stop() end
    ScreenGui:Destroy()
end)

UserInputService.InputBegan:Connect(function(input, gpe)
    if not gpe and input.KeyCode == Enum.KeyCode.F1 then
        Main.Visible = not Main.Visible
    end
end)

print("DELTA HUB: Press F1 to Toggle")
